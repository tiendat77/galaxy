<div class="container">
  <div class="content" fxLayout="column" fxFlex>
    <mat-toolbar class="toolbar" fxLayoutAlign="space-between center">
      <div class="title" fxLayoutAlign="start center">
        <span>{{ 'MODULE.REPORTED.REPORTED' | translate }}</span>

        <!-- <button mat-icon-button color="primary"
                [matTooltip]="'GENERAL.TEXT.VIEW_GUIDE' | translate"
                (click)="guides.openGuide()">
          <mat-icon>help_outline</mat-icon>
        </button> -->

        <button mat-icon-button color="primary" style="margin: 0 8px;" matTooltip="Do something awesome here" (click)="test()">
          <mat-icon>
            <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="24" height="24" viewBox="0 0 24 24">
              <path d="M21,16C21,15.5 20.95,15.08 20.88,14.68L22.45,13.9L21.55,12.1L20.18,12.79C19.63,11.96 18.91,11.5 18.29,11.28L18.95,9.32L17.05,8.68L16.29,10.96C14.96,10.83 14.17,10.32 13.7,9.77L15.45,8.9L14.55,7.1L13,7.89C12.97,7.59 12.86,6.72 12.28,5.87L13.83,3.55L12.17,2.44L10.76,4.56C10.28,4.33 9.7,4.15 9,4.06V2H7V4.1C6.29,4.25 5.73,4.54 5.32,4.91L2.7,2.29L1.29,3.71L4.24,6.65C4,7.39 4,8 4,8H2V10H4.04C4.1,10.63 4.21,11.36 4.4,12.15L1.68,13.05L2.31,14.95L5,14.05C5.24,14.56 5.5,15.08 5.82,15.58L3.44,17.17L4.55,18.83L7.07,17.15C7.63,17.71 8.29,18.21 9.06,18.64L8.1,20.55L9.89,21.45L10.89,19.45L10.73,19.36C11.68,19.68 12.76,19.9 14,19.97V22H16V19.93C16.76,19.84 17.81,19.64 18.77,19.19L20.29,20.71L21.7,19.29L20.37,17.95C20.75,17.44 21,16.8 21,16M8.5,11A1.5,1.5 0 0,1 7,9.5A1.5,1.5 0 0,1 8.5,8A1.5,1.5 0 0,1 10,9.5A1.5,1.5 0 0,1 8.5,11M11,14A1,1 0 0,1 10,13A1,1 0 0,1 11,12A1,1 0 0,1 12,13A1,1 0 0,1 11,14M15.5,17A1.5,1.5 0 0,1 14,15.5A1.5,1.5 0 0,1 15.5,14A1.5,1.5 0 0,1 17,15.5A1.5,1.5 0 0,1 15.5,17Z" />
            </svg>
          </mat-icon>
        </button>
      </div>

      <div fxLayoutAlign="end center">
        <button mat-icon-button color="primary"
                [matTooltip]="'GENERAL.TIP.REFRESH' | translate"
                (click)="refresh()">
          <mat-icon>refresh</mat-icon>
        </button>

        <mat-menu #settingMenu="matMenu"></mat-menu>
      </div>
    </mat-toolbar>

    <div class="main" fxLayoutAlign="space-between stretch" fxFlex>
      <div class="side-nav" fxFlex="480px">
        <div class="header" fxLayoutAlign="center center">
          <span class="title">{{ 'REPORTED.TEXT.REPORT_CATEGORIES' | translate }}</span>
        </div>

        <div class="scroll list">
          <div class="search">
            <mat-form-field floatLabel="never" appearance="outline" fxFlex>
              <mat-icon matPrefix class="search-icon">search</mat-icon>

              <input matInput autocomplete="off"
                     [placeholder]="'REPORTED.PLACEHOLDER.SEARCH_REPORT' | translate"
                     [formControl]="reportCtrl">

              <button mat-icon-button matSuffix color="warn"
                      *ngIf="reportCtrl.value"
                      (click)="onClearSearch()">
                <mat-icon>clear</mat-icon>
              </button>
            </mat-form-field>
          </div>

          <mat-list *ngIf="(service.reports$ | async).length; else noReports">
            <mat-list-item *ngFor="let report of filteredReports$ | async"
                           (click)="onSelectReport(report)">
              <mat-icon matListIcon>assignment</mat-icon>
              <h3 matLine> {{ report.name }} </h3>
            </mat-list-item>
          </mat-list>

          <ng-template #noReports>
            <div class="no-reports" fxFlex>
              <span>{{ 'REPORTED.TEXT.NO_REPORT' | translate }}</span>
            </div>
          </ng-template>
        </div>
      </div>

      <div class="params" fxFlex *ngIf="reportID; else selectReport">
        <div class="header" fxLayoutAlign="space-between center">
          <span class="title">{{ 'REPORTED.TEXT.PARAM_LIST' | translate }}</span>

          <div>
            <button mat-icon-button color="primary"
                    class="menu-button"
                    [matMenuTriggerFor]="filterOptions">
              <mat-icon>more_vert</mat-icon>
            </button>

            <mat-menu #filterOptions="matMenu">
              <button mat-menu-item (click)="onClearForm()">
                <mat-icon color="warn">clear</mat-icon>
                <span>{{ 'REPORTED.ACTION.CLEAR_FORM' | translate }}</span>
              </button>
            </mat-menu>
          </div>
        </div>

        <div class="scroll param-list" fxFlex
             *ngIf="service.params.length || service.paramsDMY.length; else noParams">
          <ng-container *ngIf="service.paramsDMY.length">
            <div class="param">
              <app-form-date-month-year [(data)]="service.paramsDMY">
              </app-form-date-month-year>
            </div>
          </ng-container>

          <ng-container *ngFor="let param of service.params">
            <div class="param" [ngSwitch]="param.type">
              <app-form-select *ngSwitchCase="'select'"
                               [(value)]="param.value"
                               [source]="param.source"
                               [label]="param.name"
                               [multiple]="false"
                               [required]="param.require"
                               [enableSearch]="true">
              </app-form-select>

              <app-form-select *ngSwitchCase="'multi_select'"
                               [(value)]="param.value"
                               [source]="param.source"
                               [label]="param.name"
                               [multiple]="true"
                               [required]="param.require"
                               [enableSearch]="true">
              </app-form-select>

              <mat-form-field *ngSwitchDefault appearance="outline" style="width: 100%;">
                <mat-label>{{ param.name }}</mat-label>
                <input matInput autocomplete="off" [(ngModel)]="param.value">
              </mat-form-field>
            </div>
          </ng-container>
        </div>

        <ng-template #noParams>
          <div class="no-params" fxFlex>
            <span>
              {{ 'REPORTED.TEXT.NO_PARAM' | translate }}
            </span>
          </div>
        </ng-template>

        <div class="footer" fxLayoutAlign="center center">
          <button mat-raised-button
                  class="export-button"
                  (click)="export()">
            <mat-icon>import_export</mat-icon>
            <span>{{ 'REPORTED.ACTION.EXPORT' | translate }}</span>
          </button>
        </div>
      </div>

      <ng-template #selectReport>
        <div class="select-report" fxFlex>
          <span>{{ 'REPORTED.TEXT.SELECT_REPORT' | translate }}</span>
        </div>
      </ng-template>
    </div>
  </div>
</div>